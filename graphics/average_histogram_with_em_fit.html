<!DOCTYPE html>
<html>
<head>
    <title>Average Feature UMI counts</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <div id="plot" style="width:100%;height:600px;"></div>
    <script>
        var hist_x = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97];
        var hist_y = [0, 595, 119, 48, 26, 17, 11, 8, 6, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        var y_axis_max = Math.max(...hist_y) * 1.1;
        var log_y_min = Math.log10(0.5);
        var log_y_max = (y_axis_max > 0) ? Math.log10(y_axis_max) : 0;
        var fit_x = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97];
        var fit_y = [190.664179, 271.810747, 196.180684, 96.782384, 38.496281, 15.041501, 7.480856, 5.150467, 4.205935, 3.596412, 3.090208, 2.644819, 2.252527, 1.909870, 1.613049, 1.357744, 1.139449, 0.953734, 0.796416, 0.663648, 0.551964, 0.458285, 0.379910, 0.314487, 0.259988, 0.214673, 0.177058, 0.145882, 0.120080, 0.098752, 0.081144, 0.066624, 0.054661, 0.044816, 0.036719, 0.030067, 0.024606, 0.020125, 0.016452, 0.013443, 0.010978, 0.008962, 0.007313, 0.005965, 0.004863, 0.003964, 0.003229, 0.002630, 0.002141, 0.001743, 0.001418, 0.001154, 0.000938, 0.000763, 0.000620, 0.000504, 0.000409, 0.000332, 0.000270, 0.000219, 0.000178, 0.000144, 0.000117, 0.000095, 0.000077, 0.000062, 0.000051, 0.000041, 0.000033, 0.000027, 0.000022, 0.000018, 0.000014, 0.000012, 0.000009, 0.000008, 0.000006, 0.000005, 0.000004, 0.000003, 0.000003, 0.000002, 0.000002, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000];
        var comp0_x = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97];
        var comp0_y = [186.336525, 265.741226, 189.491565, 90.080248, 32.116671, 9.160548, 2.177365, 0.443603, 0.079080, 0.012531, 0.001787, 0.000232, 0.000028, 0.000003, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000];
        var comp1_x = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97];
        var comp1_y = [4.327654, 6.069521, 6.689119, 6.702136, 6.379610, 5.880953, 5.303492, 4.706864, 4.126855, 3.583881, 3.088421, 2.644588, 2.252500, 1.909867, 1.613049, 1.357744, 1.139449, 0.953734, 0.796416, 0.663648, 0.551964, 0.458285, 0.379910, 0.314487, 0.259988, 0.214673, 0.177058, 0.145882, 0.120080, 0.098752, 0.081144, 0.066624, 0.054661, 0.044816, 0.036719, 0.030067, 0.024606, 0.020125, 0.016452, 0.013443, 0.010978, 0.008962, 0.007313, 0.005965, 0.004863, 0.003964, 0.003229, 0.002630, 0.002141, 0.001743, 0.001418, 0.001154, 0.000938, 0.000763, 0.000620, 0.000504, 0.000409, 0.000332, 0.000270, 0.000219, 0.000178, 0.000144, 0.000117, 0.000095, 0.000077, 0.000062, 0.000051, 0.000041, 0.000033, 0.000027, 0.000022, 0.000018, 0.000014, 0.000012, 0.000009, 0.000008, 0.000006, 0.000005, 0.000004, 0.000003, 0.000003, 0.000002, 0.000002, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000];
        var histogram_trace = {
            x: hist_x,
            y: hist_y,
            type: 'bar',
            name: 'Observed Histogram',
            marker: { color: 'rgba(55, 128, 191, 0.7)', line: { color: 'rgba(55, 128, 191, 1.0)', width: 1 } },
            opacity: 0.7
        };
        var fit_trace = {
            x: fit_x,
            y: fit_y,
            type: 'scatter',
            mode: 'lines',
            name: 'Overall EM Fit (2 components)',
            line: { color: 'red', width: 3 }
        };
        var comp0_trace = {
            x: comp0_x,
            y: comp0_y,
            type: 'scatter',
            mode: 'lines',
            name: 'Component 1: Background (Poisson) (Î»=1.426, w=0.914)',
            line: { color: 'blue', width: 2, dash: 'dot' },
            opacity: 0.8
        };
        var comp1_trace = {
            x: comp1_x,
            y: comp1_y,
            type: 'scatter',
            mode: 'lines',
            name: 'Component 2: Signal (NB) (r=1.749, p=0.198, w=0.086)',
            line: { color: 'green', width: 2, dash: 'dashdot' },
            opacity: 0.8
        };
        var min_cutoff_trace = {
            x: [8, 8],
            y: [0, y_axis_max],
            type: 'scatter',
            mode: 'lines',
            name: 'Min Signal Cutoff (8)',
            line: { color: 'darkgreen', width: 2, dash: 'dash' },
            showlegend: true
        };
        var max_cutoff_trace = {
            x: [16, 16],
            y: [0, y_axis_max],
            type: 'scatter',
            mode: 'lines',
            name: 'Max Signal Cutoff (16)',
            line: { color: 'darkorange', width: 2, dash: 'dash' },
            showlegend: true
        };
        var posterior_trace = {
            x: [null],
            y: [null],
            type: 'scatter',
            mode: 'markers',
            name: 'Posterior Cutoff: 0.950',
            marker: { size: 0 },
            showlegend: true
        };
        var layout = {
            title: {
                text: 'Average Feature UMI counts<br><sub>BIC: 285831.62, Components: 2</sub>',
                x: 0.5
            },
            xaxis: {
                title: 'UMI counts',
                type: 'linear',
                range: [0.5, 20]
            },
            yaxis: {
                title: 'Frequency',
                type: 'linear',
                autorange: true
            },
            updatemenus: [
                {
                    buttons: [
                        {
                            args: [{'yaxis.type': 'linear', 'yaxis.autorange': true}],
                            label: 'Linear Y-axis',
                            method: 'relayout'
                        },
                        {
                            args: [{'yaxis.type': 'log', 'yaxis.range': [log_y_min, log_y_max]}],
                            label: 'Log Y-axis',
                            method: 'relayout'
                        }
                    ],
                    direction: 'down',
                    pad: {t: 10, r: 10},
                    showactive: true,
                    type: 'dropdown',
                    x: 0.1,
                    xanchor: 'left',
                    y: 1.15,
                    yanchor: 'top'
                }
            ],
            showlegend: true,
            legend: {
                x: 1.02,
                y: 1.0,
                xanchor: 'left',
                yanchor: 'top',
                bgcolor: 'rgba(255,255,255,0.8)',
                bordercolor: 'black',
                borderwidth: 1
            },
            hovermode: 'x unified'
        };
        var data = [histogram_trace, fit_trace, comp0_trace, comp1_trace, min_cutoff_trace, max_cutoff_trace, posterior_trace];
        Plotly.newPlot('plot', data, layout);
    </script>
</body>
</html>
